<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fish Finder - ë‚ ì”¨ ê¸°ë°˜ ì–´ì¢… ì¶”ì²œ</title>
    <style>
        :root {
            --primary-color: #2c5aa0;
            --secondary-color: #4a90e2;
            --accent-color: #f39c12;
            --success-color: #27ae60;
            --warning-color: #e74c3c;
            --text-color: #2c3e50;
            --bg-color: #ecf0f1;
            --card-bg: #ffffff;
            --border-color: #bdc3c7;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        [data-theme="dark"] {
            --text-color: #ecf0f1;
            --bg-color: #2c3e50;
            --card-bg: #34495e;
            --border-color: #4a5568;
            --shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem 0;
            box-shadow: var(--shadow);
        }

        .header-content {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            align-items: center;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            text-align: center;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            align-items: flex-end;
            margin-top: 1rem;
            max-width: 100%;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            min-width: 150px;
            flex: 0 0 auto;
        }

        .season-display {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 0.75rem;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--text-color);
            box-sizing: border-box;
        }

        .season-display.spring {
            border-color: #4CAF50;
            background: #E8F5E8;
            color: #2E7D32;
        }

        .season-display.summer {
            border-color: #FF9800;
            background: #FFF3E0;
            color: #E65100;
        }

        .season-display.autumn {
            border-color: #FF5722;
            background: #FBE9E7;
            color: #D84315;
        }

        .season-display.winter {
            border-color: #2196F3;
            background: #E3F2FD;
            color: #1565C0;
        }

        .tide-display {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 0.75rem;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--text-color);
            box-sizing: border-box;
        }

        .tide-display.good {
            border-color: #4CAF50;
            background: #E8F5E8;
            color: #2E7D32;
        }

        .tide-display.excellent {
            border-color: #FFD700;
            background: #FFFDE7;
            color: #F57F17;
            animation: pulse 2s infinite;
        }

        .tide-display.difficult {
            border-color: #F44336;
            background: #FFEBEE;
            color: #C62828;
        }

        .tide-display.poor {
            border-color: #9E9E9E;
            background: #F5F5F5;
            color: #616161;
        }

        .tide-display.unknown {
            border-color: #607D8B;
            background: #ECEFF1;
            color: #455A64;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        label {
            font-weight: 600;
            font-size: 0.9rem;
        }

        input, select, button {
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            height: 48px;
            box-sizing: border-box;
        }

        input:focus, select:focus, button:focus-visible {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(243, 144, 18, 0.2);
        }

        .btn {
            background: var(--accent-color);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            min-width: 120px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
        }

        .btn:hover {
            background: #e67e22;
            transform: translateY(-2px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--secondary-color);
        }

        .btn-secondary:hover {
            background: #357abd;
        }

        /* Main Content */
        main {
            padding: 2rem 0;
            min-height: 60vh;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            font-size: 1.2rem;
            color: var(--text-color);
        }

        .spinner {
            border: 4px solid var(--border-color);
            border-top: 4px solid var(--accent-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .weather-section {
            margin-bottom: 2rem;
        }

        .weather-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            margin-bottom: 1rem;
        }

        .weather-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .location {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .weather-main {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .weather-item {
            text-align: center;
            padding: 1rem;
            background: var(--bg-color);
            border-radius: 8px;
        }

        .weather-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .weather-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 0.25rem;
        }

        .fish-section {
            margin-top: 2rem;
        }

        .fish-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .fish-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease;
        }

        .fish-card:hover {
            transform: translateY(-5px);
        }

        .fish-name {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .fish-reason {
            color: var(--text-color);
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .fish-tips {
            background: var(--bg-color);
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid var(--accent-color);
        }

        .fish-tips h4 {
            color: var(--accent-color);
            margin-bottom: 0.5rem;
        }

        .fish-tips ul {
            list-style: none;
            padding-left: 0;
        }

        .fish-tips li {
            padding: 0.25rem 0;
            position: relative;
            padding-left: 1.5rem;
        }

        .fish-tips li::before {
            content: "ğŸ£";
            position: absolute;
            left: 0;
        }

        .tide-tip {
            background: #E3F2FD;
            border: 1px solid #2196F3;
            border-radius: 6px;
            padding: 0.75rem;
            margin-top: 0.75rem;
            color: #1565C0;
            font-size: 0.9rem;
        }

        .tide-info {
            background: var(--bg-color);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            border-left: 4px solid var(--accent-color);
        }

        .tide-info h4 {
            color: var(--accent-color);
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .tide-info p {
            margin: 0.25rem 0;
            line-height: 1.4;
        }

        .fishing-shop {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            color: white;
            text-align: center;
        }

        .fishing-shop h4 {
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .fishing-shop a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            display: inline-block;
            margin-top: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        .fishing-shop a:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .shop-info {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }

        .fishing-gear {
            background: #F8F9FA;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            border-left: 4px solid #28a745;
        }

        .fishing-gear h4 {
            color: #28a745;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .gear-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .gear-item {
            background: #E8F5E8;
            color: #2E7D32;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 500;
            border: 1px solid #C8E6C9;
        }

        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        [data-theme="dark"] .warning {
            background: #664d03;
            border-color: #997404;
            color: #fff3cd;
        }

        /* Footer */
        footer {
            background: var(--card-bg);
            border-top: 1px solid var(--border-color);
            padding: 2rem 0;
            margin-top: 3rem;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .footer-links {
            display: flex;
            gap: 1rem;
        }

        .footer-links a {
            color: var(--text-color);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: var(--accent-color);
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem 1.5rem;
            box-shadow: var(--shadow);
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 400px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            border-left: 4px solid var(--warning-color);
        }

        .toast.success {
            border-left: 4px solid var(--success-color);
        }

        .toast-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .toast-close {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--text-color);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                padding: 0 1rem;
            }

            h1 {
                font-size: 2rem;
            }

            .controls {
                flex-direction: column;
                width: 100%;
                align-items: stretch;
            }

            .input-group {
                width: 100%;
                min-width: auto;
            }

            input, select, button {
                width: 100%;
                height: 48px;
            }

            .weather-main {
                grid-template-columns: 1fr;
            }

            .fish-grid {
                grid-template-columns: 1fr;
            }

            .footer-content {
                flex-direction: column;
                text-align: center;
            }
        }

        /* Dark mode toggle */
        .theme-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 100;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        /* Utility classes */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
    </style>
</head>
<body>
    <div class="theme-toggle" onclick="toggleTheme()" aria-label="ë‹¤í¬ ëª¨ë“œ í† ê¸€" role="button" tabindex="0">
        <span id="theme-icon">ğŸŒ™</span>
    </div>

    <header>
        <div class="container">
            <div class="header-content">
                <h1>ğŸ£ Fish Finder</h1>
                <p class="subtitle">ë‚ ì”¨ì™€ ìœ„ì¹˜ ê¸°ë°˜ ìµœì ì˜ ì–´ì¢… ì¶”ì²œ ì„œë¹„ìŠ¤</p>
                
                <div class="controls">
                    <div class="input-group">
                        <label for="environment">ë‚šì‹œ í™˜ê²½</label>
                        <select id="environment" aria-label="ë‚šì‹œ í™˜ê²½ ì„ íƒ">
                            <option value="sea">ë°”ë‹¤</option>
                            <option value="freshwater">ë¯¼ë¬¼</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="season-display">í˜„ì¬ ê³„ì ˆ</label>
                        <div id="season-display" class="season-display">
                            <span id="current-season">ê³„ì ˆ í™•ì¸ ì¤‘...</span>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label for="tide-display">ë¬¼ë•Œ ì •ë³´</label>
                        <div id="tide-display" class="tide-display">
                            <span id="current-tide">ë¬¼ë•Œ í™•ì¸ ì¤‘...</span>
                        </div>
                    </div>
                    
                    <button class="btn" onclick="getLocation()" aria-label="í˜„ì¬ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°">
                        ğŸ“ ë‚´ ìœ„ì¹˜
                    </button>
                    
                    <button class="btn btn-secondary" onclick="refreshData()" aria-label="ë°ì´í„° ìƒˆë¡œê³ ì¹¨">
                        ğŸ”„ ìƒˆë¡œê³ ì¹¨
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <div id="loading" class="loading hidden">
                <div class="spinner"></div>
                <p>ë‚ ì”¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘...</p>
            </div>

            <div id="content" class="hidden">
                <section class="weather-section" aria-labelledby="weather-heading">
                    <h2 id="weather-heading" class="hidden">í˜„ì¬ ë‚ ì”¨ ì •ë³´</h2>
                    <div id="weather-card" class="weather-card"></div>
                </section>

                <section class="fish-section" aria-labelledby="fish-heading">
                    <h2 id="fish-heading">ì¶”ì²œ ì–´ì¢…</h2>
                    <div id="fish-grid" class="fish-grid"></div>
                </section>
            </div>

            <div id="error-message" class="hidden">
                <div class="weather-card text-center">
                    <h3>ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</h3>
                    <p id="error-text"></p>
                    <button class="btn mt-2" onclick="retry()">ë‹¤ì‹œ ì‹œë„</button>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div>
                    <p>&copy; 2024 Fish Finder. ë‚ ì”¨ ë°ì´í„° ì œê³µ: <a href="https://openweathermap.org" target="_blank" rel="noopener">OpenWeatherMap</a></p>
                </div>
                <div class="footer-links">
                    <button class="btn btn-secondary" onclick="copyLink()" aria-label="í˜„ì¬ ê²°ê³¼ ë§í¬ ë³µì‚¬">ğŸ”— ë§í¬ ë³µì‚¬</button>
                    <a href="#" onclick="toggleTheme()" aria-label="ë‹¤í¬ ëª¨ë“œ í† ê¸€">ğŸŒ™ í…Œë§ˆ ë³€ê²½</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Global variables
        let currentLocation = null;
        let weatherData = null;
        let fishRecommendations = null;
        const CACHE_TTL = 10 * 60 * 1000; // 10 minutes

        // í•œêµ­ ë‚šì‹œì‡¼í•‘ëª° ë°ì´í„°ë² ì´ìŠ¤
        const fishingShops = [
            {
                name: "ë‚šì‹œë§ˆíŠ¸",
                url: "https://www.fishingmart.co.kr",
                description: "ì „êµ­ ìµœëŒ€ ë‚šì‹œìš©í’ˆ ì „ë¬¸ëª°",
                specialties: ["ë°”ë‹¤ë‚šì‹œ", "ë¯¼ë¬¼ë‚šì‹œ", "ë£¨ì–´ë‚šì‹œ", "í”Œë¼ì´ë‚šì‹œ"]
            },
            {
                name: "ë‚šì‹œì½”ë¦¬ì•„",
                url: "https://www.fishingkorea.co.kr",
                description: "ë‚šì‹œìš©í’ˆ ì „ë¬¸ ì‡¼í•‘ëª°",
                specialties: ["ë°”ë‹¤ë‚šì‹œ", "ë¯¼ë¬¼ë‚šì‹œ", "ì±„ë¹„", "ë‚šì‹œëŒ€"]
            },
            {
                name: "ë‚šì‹œì›”ë“œ",
                url: "https://www.fishingworld.co.kr",
                description: "ë‚šì‹œìš©í’ˆ ì¢…í•©ëª°",
                specialties: ["ë°”ë‹¤ë‚šì‹œ", "ë¯¼ë¬¼ë‚šì‹œ", "ë£¨ì–´", "ë¯¸ë¼"]
            },
            {
                name: "ë‚šì‹œëœë“œ",
                url: "https://www.fishingland.co.kr",
                description: "ë‚šì‹œìš©í’ˆ ì „ë¬¸ì ",
                specialties: ["ë°”ë‹¤ë‚šì‹œ", "ë¯¼ë¬¼ë‚šì‹œ", "ì±„ë¹„", "ë‚šì‹œë³µ"]
            },
            {
                name: "ë‚šì‹œí”„ë¡œ",
                url: "https://www.fishingpro.co.kr",
                description: "í”„ë¡œ ë‚šì‹œìš©í’ˆ ì „ë¬¸ëª°",
                specialties: ["ë°”ë‹¤ë‚šì‹œ", "ë¯¼ë¬¼ë‚šì‹œ", "ê³ ê¸‰ì±„ë¹„", "ë‚šì‹œëŒ€"]
            },
            {
                name: "ë‚šì‹œí—ˆë¸Œ",
                url: "https://www.fishinghub.co.kr",
                description: "ë‚šì‹œìš©í’ˆ ì›ìŠ¤í†± ì‡¼í•‘",
                specialties: ["ë°”ë‹¤ë‚šì‹œ", "ë¯¼ë¬¼ë‚šì‹œ", "ë£¨ì–´", "ì±„ë¹„"]
            },
            {
                name: "ë‚šì‹œìŠ¤í† ì–´",
                url: "https://www.fishingstore.co.kr",
                description: "ë‚šì‹œìš©í’ˆ ì „ë¬¸ ì‡¼í•‘ëª°",
                specialties: ["ë°”ë‹¤ë‚šì‹œ", "ë¯¼ë¬¼ë‚šì‹œ", "ë¯¸ë¼", "ë‚šì‹œëŒ€"]
            },
            {
                name: "ë‚šì‹œë§ˆìŠ¤í„°",
                url: "https://www.fishingmaster.co.kr",
                description: "ë‚šì‹œìš©í’ˆ ì „ë¬¸ëª°",
                specialties: ["ë°”ë‹¤ë‚šì‹œ", "ë¯¼ë¬¼ë‚šì‹œ", "ì±„ë¹„", "ë£¨ì–´"]
            }
        ];

        // ì–´ì¢…ë³„ ì±„ë¹„ ì •ë³´
        const fishingGear = {
            "ì£¼ê¾¸ë¯¸": ["ìƒˆìš° ë¯¸ë¼", "ì‘ì€ ìƒì„  ë¯¸ë¼", "ë°”ëŠ˜ 2-3í˜¸", "ë‚šì‹œëŒ€ 2-2.5m", "ì‹¤ 2-3í˜¸", "ì£¼ê¾¸ë¯¸ ì „ìš© ì±„ë¹„"],
            "ì „ê°±ì´": ["ìƒˆìš° ë¯¸ë¼", "ì‘ì€ ìƒì„  ë¯¸ë¼", "ë°”ëŠ˜ 2-4í˜¸", "ë‚šì‹œëŒ€ 2-3m", "ì‹¤ 2-4í˜¸"],
            "ê°ˆì¹˜": ["ìƒì„  ì¡°ê°", "ì˜¤ì§•ì–´ ë¯¸ë¼", "ë°”ëŠ˜ 4-6í˜¸", "ë‚šì‹œëŒ€ 3-4m", "ì‹¤ 4-6í˜¸"],
            "ê´‘ì–´": ["ê°¯ì§€ë ì´", "ìƒˆìš° ë¯¸ë¼", "ë°”ëŠ˜ 3-5í˜¸", "ë‚šì‹œëŒ€ 2.5-3.5m", "ì‹¤ 3-5í˜¸"],
            "ìš°ëŸ­": ["ê°¯ì§€ë ì´", "ì‘ì€ ìƒì„ ", "ë°”ëŠ˜ 3-5í˜¸", "ë‚šì‹œëŒ€ 2.5-3.5m", "ì‹¤ 3-5í˜¸"],
            "ë”": ["ìƒˆìš°", "ê°¯ì§€ë ì´", "ë°”ëŠ˜ 2-4í˜¸", "ë‚šì‹œëŒ€ 2-3m", "ì‹¤ 2-4í˜¸"],
            "ê³ ë“±ì–´": ["ìƒˆìš°", "ì‘ì€ ìƒì„ ", "ë°”ëŠ˜ 3-5í˜¸", "ë‚šì‹œëŒ€ 2.5-3.5m", "ì‹¤ 3-5í˜¸"],
            "ë°°ìŠ¤": ["ìŠ¤í”¼ë„ˆë² ì´íŠ¸", "í¬ë­í¬ë² ì´íŠ¸", "ë°”ëŠ˜ 1-3í˜¸", "ë‚šì‹œëŒ€ 1.8-2.4m", "ì‹¤ 1-3í˜¸"],
            "ë¸”ë£¨ê¸¸": ["ì§€ë ì´", "ë°¥ë²Œë ˆ", "ë°”ëŠ˜ 1-2í˜¸", "ë‚šì‹œëŒ€ 1.5-2m", "ì‹¤ 1-2í˜¸"],
            "ë¶•ì–´": ["ë¹µ", "ì˜¥ìˆ˜ìˆ˜", "ë°”ëŠ˜ 2-4í˜¸", "ë‚šì‹œëŒ€ 2-3m", "ì‹¤ 2-4í˜¸"],
            "ì‰ì–´": ["ì˜¥ìˆ˜ìˆ˜", "ë¹µ", "ë°”ëŠ˜ 4-8í˜¸", "ë‚šì‹œëŒ€ 3-4m", "ì‹¤ 4-8í˜¸"],
            "ë©”ê¸°": ["ìƒì„  ì¡°ê°", "ì§€ë ì´", "ë°”ëŠ˜ 4-8í˜¸", "ë‚šì‹œëŒ€ 3-4m", "ì‹¤ 4-8í˜¸"]
        };

        // ëœë¤ ì‡¼í•‘ëª° ì„ íƒ í•¨ìˆ˜
        function getRandomFishingShop() {
            const randomIndex = Math.floor(Math.random() * fishingShops.length);
            return fishingShops[randomIndex];
        }

        // ì–´ì¢…ë³„ ì±„ë¹„ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        function getFishingGearForFish(fishName) {
            return fishingGear[fishName] || ["ì¼ë°˜ ë‚šì‹œìš©í’ˆ", "ë°”ëŠ˜", "ë‚šì‹œëŒ€", "ì‹¤", "ë¯¸ë¼"];
        }

        // Fish species database
        const fishDatabase = {
            sea: {
                spring: [
                    { name: "ì „ê°±ì´", temp: [15, 25], wind: [0, 10], reason: "ë´„ì²  ìˆ˜ì˜¨ ìƒìŠ¹ê³¼ í•¨ê»˜ í™œë°œí•´ì§€ëŠ” ì–´ì¢…", tips: ["ìƒˆìš°ë‚˜ ì‘ì€ ìƒì„ ì„ ë¯¸ë¼ë¡œ ì‚¬ìš©", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ìƒˆë²½ê³¼ ì €ë… ì‹œê°„ëŒ€ê°€ ì¢‹ìŒ"] },
                    { name: "ê°ˆì¹˜", temp: [18, 28], wind: [0, 8], reason: "ë´„ì²  íšŒìœ  ì‹œê¸°ë¡œ í™œë°œí•œ ì–´ì¢…", tips: ["ìƒì„  ì¡°ê°ì´ë‚˜ ì˜¤ì§•ì–´ë¥¼ ë¯¸ë¼ë¡œ", "ê¹Šì€ ë°”ë‹¤ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ê°•í•œ ì§€ì—­ ì„ í˜¸"] },
                    { name: "ê´‘ì–´", temp: [12, 22], wind: [0, 12], reason: "ë´„ì²  ì‚°ë€ê¸°ë¡œ ì—°ì•ˆì— ì ‘ê·¼", tips: ["ê°¯ì§€ë ì´ë‚˜ ìƒˆìš°ë¥¼ ë¯¸ë¼ë¡œ", "ëª¨ë˜ ë°”ë‹¥ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ìˆ˜ ê°„ë§Œì˜ ì°¨ê°€ í° ì‹œê°„"] },
                    { name: "ìš°ëŸ­", temp: [10, 20], wind: [0, 15], reason: "ë´„ì²  ìˆ˜ì˜¨ ìƒìŠ¹ìœ¼ë¡œ í™œë°œí•´ì§", tips: ["ê°¯ì§€ë ì´ë‚˜ ì‘ì€ ìƒì„ ì„ ë¯¸ë¼ë¡œ", "ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ì£¼ê¾¸ë¯¸", temp: [14, 24], wind: [0, 12], reason: "ë´„ì²  ì£¼ê¾¸ë¯¸ í™œë™ ì‹œì‘", tips: ["ìƒˆìš°ë‚˜ ì‘ì€ ìƒì„ ì„ ë¯¸ë¼ë¡œ ì‚¬ìš©", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ìƒˆë²½ê³¼ ì €ë… ì‹œê°„ëŒ€ê°€ ì¢‹ìŒ"] }
                ],
                summer: [
                    { name: "ì „ê°±ì´", temp: [20, 30], wind: [0, 12], reason: "ì—¬ë¦„ì²  ë†’ì€ ìˆ˜ì˜¨ì—ì„œ í™œë°œí•œ ì–´ì¢…", tips: ["ìƒˆìš°ë‚˜ ì‘ì€ ìƒì„ ì„ ë¯¸ë¼ë¡œ ì‚¬ìš©", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ìƒˆë²½ê³¼ ì €ë… ì‹œê°„ëŒ€ê°€ ì¢‹ìŒ"] },
                    { name: "ê°ˆì¹˜", temp: [22, 32], wind: [0, 10], reason: "ì—¬ë¦„ì²  íšŒìœ  ì‹œê¸°ë¡œ í™œë°œí•œ ì–´ì¢…", tips: ["ìƒì„  ì¡°ê°ì´ë‚˜ ì˜¤ì§•ì–´ë¥¼ ë¯¸ë¼ë¡œ", "ê¹Šì€ ë°”ë‹¤ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ê°•í•œ ì§€ì—­ ì„ í˜¸"] },
                    { name: "ê³ ë“±ì–´", temp: [18, 28], wind: [0, 15], reason: "ì—¬ë¦„ì²  ëŒ€ëŸ‰ íšŒìœ í•˜ëŠ” ì–´ì¢…", tips: ["ìƒˆìš°ë‚˜ ì‘ì€ ìƒì„ ì„ ë¯¸ë¼ë¡œ", "ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ì£¼ê¾¸ë¯¸", temp: [18, 28], wind: [0, 12], reason: "ì—¬ë¦„ì²  ì£¼ê¾¸ë¯¸ í™œë™ ì¦ê°€", tips: ["ìƒˆìš°ë‚˜ ì‘ì€ ìƒì„ ì„ ë¯¸ë¼ë¡œ ì‚¬ìš©", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ìƒˆë²½ê³¼ ì €ë… ì‹œê°„ëŒ€ê°€ ì¢‹ìŒ"] },
                    { name: "ë”", temp: [20, 30], wind: [0, 12], reason: "ì—¬ë¦„ì²  ë†’ì€ ìˆ˜ì˜¨ì—ì„œ í™œë°œ", tips: ["ìƒˆìš°ë‚˜ ê°¯ì§€ë ì´ë¥¼ ë¯¸ë¼ë¡œ", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ìˆ˜ ê°„ë§Œì˜ ì°¨ê°€ í° ì‹œê°„"] }
                ],
                autumn: [
                    { name: "ì£¼ê¾¸ë¯¸", temp: [12, 22], wind: [0, 15], reason: "ê°€ì„ì²  ì£¼ê¾¸ë¯¸ ì‹œì¦Œ! ê°€ì¥ í™œë°œí•œ ì–´ì¢…", tips: ["ìƒˆìš°ë‚˜ ì‘ì€ ìƒì„ ì„ ë¯¸ë¼ë¡œ ì‚¬ìš©", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ìƒˆë²½ê³¼ ì €ë… ì‹œê°„ëŒ€ê°€ ìµœì "] },
                    { name: "ê°ˆì¹˜", temp: [16, 26], wind: [0, 12], reason: "ê°€ì„ì²  íšŒìœ  ì‹œê¸°ë¡œ í™œë°œí•œ ì–´ì¢…", tips: ["ìƒì„  ì¡°ê°ì´ë‚˜ ì˜¤ì§•ì–´ë¥¼ ë¯¸ë¼ë¡œ", "ê¹Šì€ ë°”ë‹¤ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ê°•í•œ ì§€ì—­ ì„ í˜¸"] },
                    { name: "ì „ê°±ì´", temp: [14, 24], wind: [0, 15], reason: "ê°€ì„ì²  ìˆ˜ì˜¨ í•˜ê°•ê³¼ í•¨ê»˜ í™œë°œ", tips: ["ìƒˆìš°ë‚˜ ì‘ì€ ìƒì„ ì„ ë¯¸ë¼ë¡œ ì‚¬ìš©", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ìƒˆë²½ê³¼ ì €ë… ì‹œê°„ëŒ€ê°€ ì¢‹ìŒ"] },
                    { name: "ìš°ëŸ­", temp: [12, 22], wind: [0, 18], reason: "ê°€ì„ì²  ìˆ˜ì˜¨ í•˜ê°•ìœ¼ë¡œ í™œë°œí•´ì§", tips: ["ê°¯ì§€ë ì´ë‚˜ ì‘ì€ ìƒì„ ì„ ë¯¸ë¼ë¡œ", "ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ê´‘ì–´", temp: [10, 20], wind: [0, 15], reason: "ê°€ì„ì²  ì‚°ë€ê¸°ë¡œ ì—°ì•ˆ ì ‘ê·¼", tips: ["ê°¯ì§€ë ì´ë‚˜ ìƒˆìš°ë¥¼ ë¯¸ë¼ë¡œ", "ëª¨ë˜ ë°”ë‹¥ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ìˆ˜ ê°„ë§Œì˜ ì°¨ê°€ í° ì‹œê°„"] }
                ],
                winter: [
                    { name: "ìš°ëŸ­", temp: [5, 15], wind: [0, 20], reason: "ê²¨ìš¸ì²  ì¶”ìš´ ìˆ˜ì˜¨ì—ì„œë„ í™œë°œí•œ ì–´ì¢…", tips: ["ê°¯ì§€ë ì´ë‚˜ ì‘ì€ ìƒì„ ì„ ë¯¸ë¼ë¡œ", "ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ê´‘ì–´", temp: [6, 16], wind: [0, 18], reason: "ê²¨ìš¸ì²  ì—°ì•ˆì—ì„œ í™œë°œí•œ ì–´ì¢…", tips: ["ê°¯ì§€ë ì´ë‚˜ ìƒˆìš°ë¥¼ ë¯¸ë¼ë¡œ", "ëª¨ë˜ ë°”ë‹¥ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ì£¼ê¾¸ë¯¸", temp: [8, 18], wind: [0, 15], reason: "ê²¨ìš¸ì²  ì£¼ê¾¸ë¯¸ í™œë™ ì§€ì†", tips: ["ìƒˆìš°ë‚˜ ì‘ì€ ìƒì„ ì„ ë¯¸ë¼ë¡œ ì‚¬ìš©", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ìƒˆë²½ê³¼ ì €ë… ì‹œê°„ëŒ€ê°€ ì¢‹ìŒ"] },
                    { name: "ë”", temp: [8, 18], wind: [0, 15], reason: "ê²¨ìš¸ì²  ìˆ˜ì˜¨ì—ì„œë„ í™œë°œ", tips: ["ìƒˆìš°ë‚˜ ê°¯ì§€ë ì´ë¥¼ ë¯¸ë¼ë¡œ", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ì „ê°±ì´", temp: [10, 20], wind: [0, 12], reason: "ê²¨ìš¸ì²  ìˆ˜ì˜¨ì—ì„œë„ í™œë°œí•œ ì–´ì¢…", tips: ["ìƒˆìš°ë‚˜ ì‘ì€ ìƒì„ ì„ ë¯¸ë¼ë¡œ ì‚¬ìš©", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ìƒˆë²½ê³¼ ì €ë… ì‹œê°„ëŒ€ê°€ ì¢‹ìŒ"] }
                ]
            },
            freshwater: {
                spring: [
                    { name: "ë°°ìŠ¤", temp: [15, 25], wind: [0, 10], reason: "ë´„ì²  ìˆ˜ì˜¨ ìƒìŠ¹ê³¼ í•¨ê»˜ í™œë°œí•´ì§€ëŠ” ì–´ì¢…", tips: ["ìŠ¤í”¼ë„ˆë² ì´íŠ¸ë‚˜ í¬ë­í¬ë² ì´íŠ¸ ì‚¬ìš©", "ì–•ì€ ìˆ˜ì´ˆ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ìƒˆë²½ê³¼ ì €ë… ì‹œê°„ëŒ€ê°€ ì¢‹ìŒ"] },
                    { name: "ë¸”ë£¨ê¸¸", temp: [12, 22], wind: [0, 12], reason: "ë´„ì²  ì‚°ë€ê¸°ë¡œ ì—°ì•ˆì— ì ‘ê·¼", tips: ["ì‘ì€ ì§€ë ì´ë‚˜ ë°¥ë²Œë ˆë¥¼ ë¯¸ë¼ë¡œ", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ìˆ˜ ê°„ë§Œì˜ ì°¨ê°€ í° ì‹œê°„"] },
                    { name: "ë¶•ì–´", temp: [10, 20], wind: [0, 15], reason: "ë´„ì²  ìˆ˜ì˜¨ ìƒìŠ¹ìœ¼ë¡œ í™œë°œí•´ì§", tips: ["ë¹µì´ë‚˜ ì˜¥ìˆ˜ìˆ˜ë¥¼ ë¯¸ë¼ë¡œ", "ì–•ì€ ìˆ˜ì´ˆ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ì‰ì–´", temp: [14, 24], wind: [0, 10], reason: "ë´„ì²  ì‚°ë€ê¸°ë¡œ ì—°ì•ˆ ì ‘ê·¼", tips: ["ì˜¥ìˆ˜ìˆ˜ë‚˜ ë¹µì„ ë¯¸ë¼ë¡œ", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ìˆ˜ ê°„ë§Œì˜ ì°¨ê°€ í° ì‹œê°„"] },
                    { name: "ë©”ê¸°", temp: [16, 26], wind: [0, 8], reason: "ë´„ì²  ìˆ˜ì˜¨ ìƒìŠ¹ìœ¼ë¡œ í™œë°œí•´ì§", tips: ["ìƒì„  ì¡°ê°ì´ë‚˜ ì§€ë ì´ë¥¼ ë¯¸ë¼ë¡œ", "ê¹Šì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ê°•í•œ ì§€ì—­ ì„ í˜¸"] }
                ],
                summer: [
                    { name: "ë°°ìŠ¤", temp: [20, 30], wind: [0, 12], reason: "ì—¬ë¦„ì²  ë†’ì€ ìˆ˜ì˜¨ì—ì„œ í™œë°œí•œ ì–´ì¢…", tips: ["ìŠ¤í”¼ë„ˆë² ì´íŠ¸ë‚˜ í¬ë­í¬ë² ì´íŠ¸ ì‚¬ìš©", "ì–•ì€ ìˆ˜ì´ˆ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ìƒˆë²½ê³¼ ì €ë… ì‹œê°„ëŒ€ê°€ ì¢‹ìŒ"] },
                    { name: "ë¸”ë£¨ê¸¸", temp: [18, 28], wind: [0, 15], reason: "ì—¬ë¦„ì²  ëŒ€ëŸ‰ íšŒìœ í•˜ëŠ” ì–´ì¢…", tips: ["ì‘ì€ ì§€ë ì´ë‚˜ ë°¥ë²Œë ˆë¥¼ ë¯¸ë¼ë¡œ", "ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ë¶•ì–´", temp: [16, 26], wind: [0, 18], reason: "ì—¬ë¦„ì²  ë†’ì€ ìˆ˜ì˜¨ì—ì„œ í™œë°œ", tips: ["ë¹µì´ë‚˜ ì˜¥ìˆ˜ìˆ˜ë¥¼ ë¯¸ë¼ë¡œ", "ì–•ì€ ìˆ˜ì´ˆ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ì‰ì–´", temp: [20, 30], wind: [0, 12], reason: "ì—¬ë¦„ì²  ë†’ì€ ìˆ˜ì˜¨ì—ì„œ í™œë°œ", tips: ["ì˜¥ìˆ˜ìˆ˜ë‚˜ ë¹µì„ ë¯¸ë¼ë¡œ", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ë©”ê¸°", temp: [22, 32], wind: [0, 10], reason: "ì—¬ë¦„ì²  ë†’ì€ ìˆ˜ì˜¨ì—ì„œ í™œë°œí•œ ì–´ì¢…", tips: ["ìƒì„  ì¡°ê°ì´ë‚˜ ì§€ë ì´ë¥¼ ë¯¸ë¼ë¡œ", "ê¹Šì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ê°•í•œ ì§€ì—­ ì„ í˜¸"] }
                ],
                autumn: [
                    { name: "ë°°ìŠ¤", temp: [14, 24], wind: [0, 15], reason: "ê°€ì„ì²  ìˆ˜ì˜¨ í•˜ê°•ê³¼ í•¨ê»˜ í™œë°œ", tips: ["ìŠ¤í”¼ë„ˆë² ì´íŠ¸ë‚˜ í¬ë­í¬ë² ì´íŠ¸ ì‚¬ìš©", "ì–•ì€ ìˆ˜ì´ˆ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ìƒˆë²½ê³¼ ì €ë… ì‹œê°„ëŒ€ê°€ ì¢‹ìŒ"] },
                    { name: "ë¸”ë£¨ê¸¸", temp: [12, 22], wind: [0, 18], reason: "ê°€ì„ì²  ìˆ˜ì˜¨ í•˜ê°•ìœ¼ë¡œ í™œë°œí•´ì§", tips: ["ì‘ì€ ì§€ë ì´ë‚˜ ë°¥ë²Œë ˆë¥¼ ë¯¸ë¼ë¡œ", "ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ë¶•ì–´", temp: [10, 20], wind: [0, 20], reason: "ê°€ì„ì²  ìˆ˜ì˜¨ í•˜ê°•ìœ¼ë¡œ í™œë°œí•´ì§", tips: ["ë¹µì´ë‚˜ ì˜¥ìˆ˜ìˆ˜ë¥¼ ë¯¸ë¼ë¡œ", "ì–•ì€ ìˆ˜ì´ˆ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ì‰ì–´", temp: [12, 22], wind: [0, 15], reason: "ê°€ì„ì²  ìˆ˜ì˜¨ í•˜ê°•ìœ¼ë¡œ í™œë°œ", tips: ["ì˜¥ìˆ˜ìˆ˜ë‚˜ ë¹µì„ ë¯¸ë¼ë¡œ", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ë©”ê¸°", temp: [14, 24], wind: [0, 12], reason: "ê°€ì„ì²  ìˆ˜ì˜¨ í•˜ê°•ìœ¼ë¡œ í™œë°œí•´ì§", tips: ["ìƒì„  ì¡°ê°ì´ë‚˜ ì§€ë ì´ë¥¼ ë¯¸ë¼ë¡œ", "ê¹Šì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ê°•í•œ ì§€ì—­ ì„ í˜¸"] }
                ],
                winter: [
                    { name: "ë¶•ì–´", temp: [5, 15], wind: [0, 20], reason: "ê²¨ìš¸ì²  ì¶”ìš´ ìˆ˜ì˜¨ì—ì„œë„ í™œë°œí•œ ì–´ì¢…", tips: ["ë¹µì´ë‚˜ ì˜¥ìˆ˜ìˆ˜ë¥¼ ë¯¸ë¼ë¡œ", "ì–•ì€ ìˆ˜ì´ˆ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ì‰ì–´", temp: [6, 16], wind: [0, 18], reason: "ê²¨ìš¸ì²  ì—°ì•ˆì—ì„œ í™œë°œí•œ ì–´ì¢…", tips: ["ì˜¥ìˆ˜ìˆ˜ë‚˜ ë¹µì„ ë¯¸ë¼ë¡œ", "ì–•ì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] },
                    { name: "ë©”ê¸°", temp: [8, 18], wind: [0, 15], reason: "ê²¨ìš¸ì²  ìˆ˜ì˜¨ì—ì„œë„ í™œë°œ", tips: ["ìƒì„  ì¡°ê°ì´ë‚˜ ì§€ë ì´ë¥¼ ë¯¸ë¼ë¡œ", "ê¹Šì€ ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ê°•í•œ ì§€ì—­ ì„ í˜¸"] },
                    { name: "ë°°ìŠ¤", temp: [10, 20], wind: [0, 12], reason: "ê²¨ìš¸ì²  ìˆ˜ì˜¨ì—ì„œë„ í™œë°œí•œ ì–´ì¢…", tips: ["ìŠ¤í”¼ë„ˆë² ì´íŠ¸ë‚˜ í¬ë­í¬ë² ì´íŠ¸ ì‚¬ìš©", "ì–•ì€ ìˆ˜ì´ˆ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ìƒˆë²½ê³¼ ì €ë… ì‹œê°„ëŒ€ê°€ ì¢‹ìŒ"] },
                    { name: "ë¸”ë£¨ê¸¸", temp: [8, 18], wind: [0, 15], reason: "ê²¨ìš¸ì²  ìˆ˜ì˜¨ì—ì„œë„ í™œë°œí•œ ì–´ì¢…", tips: ["ì‘ì€ ì§€ë ì´ë‚˜ ë°¥ë²Œë ˆë¥¼ ë¯¸ë¼ë¡œ", "ë°”ìœ„ ì§€ì—­ì—ì„œ ë‚šì‹œ", "ì¡°ë¥˜ê°€ ìˆëŠ” ì§€ì—­ ì„ í˜¸"] }
                ]
            }
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // Load saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
                updateThemeIcon(savedTheme);
            } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.setAttribute('data-theme', 'dark');
                updateThemeIcon('dark');
            }

            // Initialize season display
            updateSeasonDisplay();
            
            // Initialize tide display (with default coordinates for Seoul)
            updateTideDisplay(37.5665, 126.9780);

            // Load cached data
            loadCache();
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        }

        function updateThemeIcon(theme) {
            const icon = document.getElementById('theme-icon');
            icon.textContent = theme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
        }

        function getCurrentSeason() {
            const now = new Date();
            const month = now.getMonth() + 1; // 1-12
            
            if (month >= 3 && month <= 5) {
                return { season: 'spring', name: 'ë´„', emoji: 'ğŸŒ¸' };
            } else if (month >= 6 && month <= 8) {
                return { season: 'summer', name: 'ì—¬ë¦„', emoji: 'â˜€ï¸' };
            } else if (month >= 9 && month <= 11) {
                return { season: 'autumn', name: 'ê°€ì„', emoji: 'ğŸ‚' };
            } else {
                return { season: 'winter', name: 'ê²¨ìš¸', emoji: 'â„ï¸' };
            }
        }

        function updateSeasonDisplay() {
            const currentSeason = getCurrentSeason();
            const seasonDisplay = document.getElementById('season-display');
            const seasonText = document.getElementById('current-season');
            
            seasonText.textContent = `${currentSeason.emoji} ${currentSeason.name}`;
            seasonDisplay.className = `season-display ${currentSeason.season}`;
            
            return currentSeason.season;
        }

        function getTideNumber() {
            // í˜„ì¬ ì‹œê°„ì„ ê¸°ë°˜ìœ¼ë¡œ 1-15ë¬¼ ê³„ì‚°
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            const timeInMinutes = hours * 60 + minutes;
            
            // ì¡°ì„ ì£¼ê¸°ëŠ” ì•½ 12ì‹œê°„ 25ë¶„ (745ë¶„)
            // 15ë¬¼ë¡œ ë‚˜ëˆ„ë©´ ê° ë¬¼ë‹¹ ì•½ 49.67ë¶„
            const tideCycle = 745;
            const tidePosition = (timeInMinutes % tideCycle) / tideCycle;
            
            // 1-15ë¬¼ë¡œ ë³€í™˜ (1ë¶€í„° ì‹œì‘)
            const tideNumber = Math.floor(tidePosition * 15) + 1;
            return tideNumber;
        }

        function getTideInfo(tideNumber) {
            let tideStatus = "";
            let tideDescription = "";
            let fishingPrediction = "";
            let emoji = "ğŸ£";
            let type = "";
            let name = "";

            switch (tideNumber) {
                case 1:
                case 2:
                case 3:
                    tideStatus = "ë‚šì‹œ ì¢‹ìŒ";
                    tideDescription = "ì¡°ë¥˜ê°€ ì•½í•´ì§€ê³  ìˆìŠµë‹ˆë‹¤. ë‚šì‹œ í™œë™ì´ í™œë°œí•©ë‹ˆë‹¤.";
                    fishingPrediction = "ì¢‹ì€ ì¡°ê³¼ë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸŸ";
                    type = "good";
                    name = `${tideNumber}ë¬¼ (ë‚šì‹œ ì¢‹ìŒ)`;
                    emoji = "ğŸŸ";
                    break;
                case 4:
                case 5:
                case 6:
                    tideStatus = "ë‚šì‹œ ìµœì ";
                    tideDescription = "ë‚šì‹œì˜ 'ê³¨ë“ íƒ€ì„'ì…ë‹ˆë‹¤. ì¡°ë¥˜ê°€ ìµœì ì˜ ê°•ë„ì…ë‹ˆë‹¤.";
                    fishingPrediction = "ìµœê³ ì˜ ì¡°ê³¼ë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ë‚šì‹œí•˜ê¸° ê°€ì¥ ì¢‹ì€ ì‹œê°„ì…ë‹ˆë‹¤. âœ¨";
                    type = "excellent";
                    name = `${tideNumber}ë¬¼ (ë‚šì‹œ ìµœì )`;
                    emoji = "âœ¨";
                    break;
                case 7:
                case 8:
                case 9:
                    tideStatus = "ë‚šì‹œ ì–´ë ¤ì›€ (ì‚¬ë¦¬)";
                    tideDescription = "ì¡°ë¥˜ê°€ ê°€ì¥ ê°•í•©ë‹ˆë‹¤. ì±„ë¹„ ìœ ì§€ê°€ ì–´ë µìŠµë‹ˆë‹¤.";
                    fishingPrediction = "ì¡°ê³¼ ê°€ëŠ¥ì„±ì´ ë‚®ìŠµë‹ˆë‹¤. ğŸ’§";
                    type = "difficult";
                    name = `${tideNumber}ë¬¼ (ì‚¬ë¦¬)`;
                    emoji = "ğŸ’§";
                    break;
                case 10:
                case 11:
                case 12:
                    tideStatus = "ë‚šì‹œ ì¢‹ìŒ";
                    tideDescription = "ì¡°ë¥˜ê°€ ë‹¤ì‹œ ì•½í•´ì§€ê³  ìˆìŠµë‹ˆë‹¤. ë‚šì‹œ í™œë™ì´ ì¦ê°€í•©ë‹ˆë‹¤.";
                    fishingPrediction = "ì¢‹ì€ ì¡°ê³¼ë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸŒŠ";
                    type = "good";
                    name = `${tideNumber}ë¬¼ (ë‚šì‹œ ì¢‹ìŒ)`;
                    emoji = "ğŸŒŠ";
                    break;
                case 13:
                case 14:
                case 15:
                    tideStatus = "ë‚šì‹œ ë‚˜ì¨ (ì¡°ê¸ˆ)";
                    tideDescription = "ì¡°ë¥˜ê°€ ê°€ì¥ ì•½í•©ë‹ˆë‹¤. ë¬¼ê³ ê¸° í™œë™ì´ ì €ì¡°í•©ë‹ˆë‹¤.";
                    fishingPrediction = "ì¡°ê³¼ ê°€ëŠ¥ì„±ì´ ë‚®ìŠµë‹ˆë‹¤. ğŸ˜©";
                    type = "poor";
                    name = `${tideNumber}ë¬¼ (ì¡°ê¸ˆ)`;
                    emoji = "ğŸ˜©";
                    break;
                default:
                    tideStatus = "ë¬¼ë•Œ ì •ë³´ ì—†ìŒ";
                    tideDescription = "1-15ë¬¼ ì‚¬ì´ì˜ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.";
                    fishingPrediction = "ì•Œ ìˆ˜ ì—†ìŒ";
                    type = "unknown";
                    name = "ì•Œ ìˆ˜ ì—†ìŒ";
                    emoji = "â“";
                    break;
            }

            return {
                tideNumber: tideNumber,
                type: type,
                name: name,
                emoji: emoji,
                status: tideStatus,
                description: tideDescription,
                fishingPrediction: fishingPrediction
            };
        }

        function updateTideDisplay(lat, lon) {
            const tideNumber = getTideNumber();
            const tideInfo = getTideInfo(tideNumber);
            const tideDisplay = document.getElementById('tide-display');
            const tideText = document.getElementById('current-tide');
            
            tideText.textContent = `${tideInfo.emoji} ${tideInfo.name}`;
            tideDisplay.className = `tide-display ${tideInfo.type}`;
            tideDisplay.title = `${tideInfo.description} - ${tideInfo.fishingPrediction}`;
            
            return tideInfo;
        }


        function getLocation() {
            const apiKey = '8d171e1d1c48996e78342e40530b6f57'; // ê³ ì • API í‚¤ ì‚¬ìš©
            showLoading();

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        currentLocation = {
                            lat: position.coords.latitude,
                            lon: position.coords.longitude
                        };
                        updateTideDisplay(currentLocation.lat, currentLocation.lon);
                        fetchWeatherData();
                    },
                    function(error) {
                        console.error('Geolocation error:', error);
                        showToast('ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë„ì‹œëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                        showCityInput();
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 300000
                    }
                );
            } else {
                showToast('ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ ì„œë¹„ìŠ¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
                showCityInput();
            }
        }

        function showCityInput() {
            const cityInput = prompt('ë„ì‹œëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš” (ì˜ˆ: Seoul, Busan):');
            if (cityInput && cityInput.trim()) {
                // Use geocoding to get coordinates
                geocodeCity(cityInput.trim());
            } else {
                hideLoading();
                showError('ìœ„ì¹˜ ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.');
            }
        }

        function geocodeCity(cityName) {
            const apiKey = '8d171e1d1c48996e78342e40530b6f57'; // ê³ ì • API í‚¤ ì‚¬ìš©
            const geocodeUrl = `https://api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(cityName)}&limit=1&appid=${apiKey}`;
            
            fetch(geocodeUrl)
                .then(response => response.json())
                .then(data => {
                    if (data && data.length > 0) {
                        currentLocation = {
                            lat: data[0].lat,
                            lon: data[0].lon,
                            city: data[0].name,
                            country: data[0].country
                        };
                        updateTideDisplay(currentLocation.lat, currentLocation.lon);
                        fetchWeatherData();
                    } else {
                        throw new Error('ë„ì‹œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }
                })
                .catch(error => {
                    console.error('Geocoding error:', error);
                    showToast('ë„ì‹œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ë„ì‹œëª…ì„ ì‹œë„í•´ë³´ì„¸ìš”.', 'error');
                    hideLoading();
                    showError('ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                });
        }

        function fetchWeatherData() {
            const apiKey = '8d171e1d1c48996e78342e40530b6f57'; // ê³ ì • API í‚¤ ì‚¬ìš©
            const weatherUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${currentLocation.lat}&lon=${currentLocation.lon}&appid=${apiKey}&units=metric&lang=kr`;
            
            fetch(weatherUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    return response.json();
                })
                .then(data => {
                    weatherData = {
                        temperature: data.main.temp,
                        windSpeed: data.wind.speed,
                        weatherId: data.weather[0].id,
                        description: data.weather[0].description,
                        humidity: data.main.humidity,
                        pressure: data.main.pressure,
                        location: currentLocation.city || `${currentLocation.lat.toFixed(2)}, ${currentLocation.lon.toFixed(2)}`
                    };
                    
                    pickSpecies();
                    renderUI();
                    saveCache();
                    hideLoading();
                })
                .catch(error => {
                    console.error('Weather API error:', error);
                    let errorMessage = 'ë‚ ì”¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                    let detailedMessage = '';
                    
                    if (error.message.includes('401')) {
                        errorMessage = 'API í‚¤ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                        detailedMessage = 'OpenWeatherMapì—ì„œ API í‚¤ë¥¼ ì¸ì‹í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. í‚¤ê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.';
                    } else if (error.message.includes('429')) {
                        errorMessage = 'API í˜¸ì¶œ í•œë„ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.';
                        detailedMessage = 'ë¬´ë£Œ í”Œëœì˜ ì›” í˜¸ì¶œ í•œë„(1,000íšŒ)ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ë‹¬ê¹Œì§€ ê¸°ë‹¤ë¦¬ê±°ë‚˜ ìœ ë£Œ í”Œëœìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œí•˜ì„¸ìš”.';
                    } else if (error.message.includes('404')) {
                        errorMessage = 'ìœ„ì¹˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                        detailedMessage = 'ì…ë ¥í•œ ìœ„ì¹˜ ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ìœ„ì¹˜ë¥¼ ì‹œë„í•´ë³´ì„¸ìš”.';
                    } else if (error.message.includes('NetworkError') || error.message.includes('Failed to fetch')) {
                        errorMessage = 'ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì˜¤ë¥˜';
                        detailedMessage = 'ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                    } else {
                        detailedMessage = `ì˜¤ë¥˜ ìƒì„¸: ${error.message}`;
                    }
                    
                    showToast(errorMessage, 'error');
                    hideLoading();
                    showError(`${errorMessage}<br><small>${detailedMessage}</small>`);
                });
        }

        function pickSpecies() {
            const environment = document.getElementById('environment').value;
            const season = getCurrentSeason().season; // ìë™ìœ¼ë¡œ í˜„ì¬ ê³„ì ˆ ê°ì§€
            const temp = weatherData.temperature;
            const windSpeed = weatherData.windSpeed;
            const tideNumber = getTideNumber();
            const tideInfo = getTideInfo(tideNumber);
            
            // Get fish list for current environment and season
            const fishList = fishDatabase[environment][season];
            
            // Filter fish based on temperature and wind conditions
            const suitableFish = fishList.filter(fish => {
                const tempMatch = temp >= fish.temp[0] && temp <= fish.temp[1];
                const windMatch = windSpeed >= fish.wind[0] && windSpeed <= fish.wind[1];
                return tempMatch && windMatch;
            });
            
            // If no fish match exactly, get the top 5 from the list
            fishRecommendations = suitableFish.length > 0 ? 
                suitableFish.slice(0, 5) : 
                fishList.slice(0, 5);
            
            // Add tide-specific tips, gear info, and shopping mall to fish recommendations
            fishRecommendations = fishRecommendations.map(fish => ({
                ...fish,
                tideTip: getTideSpecificTip(fish.name, tideInfo.type, tideInfo.fishingPrediction),
                gear: getFishingGearForFish(fish.name),
                shop: getRandomFishingShop()
            }));
        }

        function getTideSpecificTip(fishName, tideType, fishingPrediction) {
            const tideTips = {
                'good': 'ì¡°ë¥˜ê°€ ì•½í•´ì ¸ ë‚šì‹œí•˜ê¸° ì¢‹ì€ ì‹œê°„ì…ë‹ˆë‹¤',
                'excellent': 'ë‚šì‹œì˜ ê³¨ë“ íƒ€ì„! ìµœê³ ì˜ ì¡°ê³¼ë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤',
                'difficult': 'ì‚¬ë¦¬ë¡œ ì¡°ë¥˜ê°€ ê°•í•´ ë‚šì‹œê°€ ì–´ë ¤ìš´ ì‹œê°„ì…ë‹ˆë‹¤',
                'poor': 'ì¡°ê¸ˆìœ¼ë¡œ ë¬¼ê³ ê¸° í™œë™ì´ ì €ì¡°í•œ ì‹œê°„ì…ë‹ˆë‹¤'
            };
            
            return tideTips[tideType] || fishingPrediction || 'í˜„ì¬ ë¬¼ë•Œì— ë§ëŠ” ë‚šì‹œë¥¼ í•˜ì„¸ìš”';
        }

        function renderUI() {
            // Get current tide info for display
            const tideNumber = getTideNumber();
            const tideInfo = getTideInfo(tideNumber);
            
            // Render weather card
            const weatherCard = document.getElementById('weather-card');
            const windWarning = weatherData.windSpeed >= 8 ? 
                '<div class="warning">âš ï¸ ê°•í’ ê²½ë³´: ë°”ëŒì´ ê°•í•©ë‹ˆë‹¤. ì•ˆì „ì— ì£¼ì˜í•˜ì„¸ìš”.</div>' : '';
            
            const tideWarning = tideInfo.type === 'excellent' ? 
                '<div class="warning" style="background: #FFFDE7; border-color: #FFD700; color: #F57F17;">âœ¨ ë‚šì‹œ ê³¨ë“ íƒ€ì„! í˜„ì¬ê°€ ìµœì ì˜ ë‚šì‹œ ì‹œê°„ì…ë‹ˆë‹¤!</div>' : 
                tideInfo.type === 'difficult' ? 
                '<div class="warning" style="background: #FFEBEE; border-color: #F44336; color: #C62828;">ğŸ’§ ì‚¬ë¦¬ ì‹œê°„: ì¡°ë¥˜ê°€ ê°•í•´ ë‚šì‹œê°€ ì–´ë ¤ìš´ ì‹œê°„ì…ë‹ˆë‹¤.</div>' : '';
            
            weatherCard.innerHTML = `
                <div class="weather-header">
                    <div class="location">ğŸ“ ${weatherData.location}</div>
                    <div class="weather-description">${weatherData.description}</div>
                </div>
                ${windWarning}
                ${tideWarning}
                <div class="weather-main">
                    <div class="weather-item">
                        <div class="weather-value">${Math.round(weatherData.temperature)}Â°C</div>
                        <div class="weather-label">ì˜¨ë„</div>
                    </div>
                    <div class="weather-item">
                        <div class="weather-value">${weatherData.windSpeed} m/s</div>
                        <div class="weather-label">í’ì†</div>
                    </div>
                    <div class="weather-item">
                        <div class="weather-value">${weatherData.humidity}%</div>
                        <div class="weather-label">ìŠµë„</div>
                    </div>
                    <div class="weather-item">
                        <div class="weather-value">${weatherData.pressure} hPa</div>
                        <div class="weather-label">ê¸°ì••</div>
                    </div>
                </div>
                <div class="tide-info">
                    <h4>ğŸŒŠ í˜„ì¬ ë¬¼ë•Œ ì •ë³´</h4>
                    <p><strong>${tideInfo.name}</strong> - ${tideInfo.description}</p>
                    <p><em>${tideInfo.fishingPrediction}</em></p>
                </div>
            `;
            
            // Render fish recommendations
            const fishGrid = document.getElementById('fish-grid');
            fishGrid.innerHTML = fishRecommendations.map(fish => `
                <div class="fish-card">
                    <h3 class="fish-name">${fish.name}</h3>
                    <p class="fish-reason">${fish.reason}</p>
                    <div class="fish-tips">
                        <h4>ë‚šì‹œ íŒ</h4>
                        <ul>
                            ${fish.tips.map(tip => `<li>${tip}</li>`).join('')}
                        </ul>
                        ${fish.tideTip ? `<div class="tide-tip"><strong>ğŸŒŠ ë¬¼ë•Œ íŒ:</strong> ${fish.tideTip}</div>` : ''}
                    </div>
                    <div class="fishing-gear">
                        <h4>ğŸ£ í•„ìš” ì±„ë¹„</h4>
                        <div class="gear-list">
                            ${fish.gear.map(gear => `<span class="gear-item">${gear}</span>`).join('')}
                        </div>
                    </div>
                    <div class="fishing-shop">
                        <h4>ğŸ›’ ì¶”ì²œ ì‡¼í•‘ëª°</h4>
                        <div class="shop-info">${fish.shop.description}</div>
                        <a href="${fish.shop.url}" target="_blank" rel="noopener">
                            ${fish.shop.name} ë°”ë¡œê°€ê¸° â†’
                        </a>
                    </div>
                </div>
            `).join('');
            
            // Show content
            document.getElementById('content').classList.remove('hidden');
            document.getElementById('error-message').classList.add('hidden');
        }

        function showLoading() {
            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('content').classList.add('hidden');
            document.getElementById('error-message').classList.add('hidden');
        }

        function hideLoading() {
            document.getElementById('loading').classList.add('hidden');
        }

        function showError(message) {
            document.getElementById('error-text').innerHTML = message;
            document.getElementById('error-message').classList.remove('hidden');
            document.getElementById('content').classList.add('hidden');
        }

        function retry() {
            if (currentLocation) {
                fetchWeatherData();
            } else {
                getLocation();
            }
        }

        function refreshData() {
            if (currentLocation) {
                fetchWeatherData();
            } else {
                getLocation();
            }
        }

        function copyLink() {
            if (!currentLocation || !weatherData) {
                showToast('ë³µì‚¬í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            const environment = document.getElementById('environment').value;
            const url = `${window.location.origin}${window.location.pathname}?lat=${currentLocation.lat}&lon=${currentLocation.lon}&env=${environment}`;
            
            navigator.clipboard.writeText(url).then(() => {
                showToast('ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            }).catch(() => {
                showToast('ë§í¬ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            });
        }

        function saveCache() {
            if (currentLocation && weatherData && fishRecommendations) {
                const cacheData = {
                    location: currentLocation,
                    weather: weatherData,
                    fish: fishRecommendations,
                    timestamp: Date.now(),
                    environment: document.getElementById('environment').value,
                    season: getCurrentSeason().season
                };
                localStorage.setItem('fishFinderCache', JSON.stringify(cacheData));
            }
        }

        function loadCache() {
            const cached = localStorage.getItem('fishFinderCache');
            if (cached) {
                try {
                    const cacheData = JSON.parse(cached);
                    const now = Date.now();
                    
                    // Check if cache is still valid (within TTL)
                    if (now - cacheData.timestamp < CACHE_TTL) {
                        currentLocation = cacheData.location;
                        weatherData = cacheData.weather;
                        fishRecommendations = cacheData.fish;
                        
                        // Restore UI state
                        document.getElementById('environment').value = cacheData.environment;
                        
                        renderUI();
                        showToast('ìºì‹œëœ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.', 'success');
                        return;
                    } else {
                        // Cache expired, remove it
                        localStorage.removeItem('fishFinderCache');
                    }
                } catch (error) {
                    console.error('Cache load error:', error);
                    localStorage.removeItem('fishFinderCache');
                }
            }
        }

        function showToast(message, type = 'info') {
            // Remove existing toasts
            const existingToasts = document.querySelectorAll('.toast');
            existingToasts.forEach(toast => toast.remove());
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-header">
                    <strong>${type === 'error' ? 'ì˜¤ë¥˜' : type === 'success' ? 'ì„±ê³µ' : 'ì•Œë¦¼'}</strong>
                    <button class="toast-close" onclick="this.parentElement.parentElement.remove()">&times;</button>
                </div>
                <div>${message}</div>
            `;
            
            document.body.appendChild(toast);
            
            // Show toast
            setTimeout(() => toast.classList.add('show'), 100);
            
            // Auto hide after 5 seconds
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 5000);
        }

        // Handle URL parameters for sharing
        function handleUrlParams() {
            const urlParams = new URLSearchParams(window.location.search);
            const lat = urlParams.get('lat');
            const lon = urlParams.get('lon');
            const env = urlParams.get('env');
            
            if (lat && lon) {
                currentLocation = {
                    lat: parseFloat(lat),
                    lon: parseFloat(lon)
                };
                
                if (env) document.getElementById('environment').value = env;
                
                // API í‚¤ëŠ” ê³ ì •ê°’ì´ë¯€ë¡œ ë°”ë¡œ í˜¸ì¶œ ê°€ëŠ¥
                fetchWeatherData();
            }
        }

        // Initialize URL params handling
        document.addEventListener('DOMContentLoaded', function() {
            handleUrlParams();
        });
    </script>
</body>
</html>
